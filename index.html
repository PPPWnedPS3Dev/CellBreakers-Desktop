<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CellBreakers Desktop</title>
  <style>
    * {margin: 0; padding: 0; box-sizing: border-box;}
    body {
      font-family: 'Segoe UI', sans-serif;
      overflow: hidden;
      background: linear-gradient(135deg, #00111a, #003366);
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      color: white;
    }
    body.light {color: black;}
    canvas#particles {position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;}
    .container {position: relative; z-index: 1; text-align: center;}
    h1 {font-size: 2.5rem; letter-spacing: 2px; text-shadow: 0 0 10px rgba(0,0,0,0.7); animation: fadeIn 1.5s ease-in-out;}
    .welcome {font-size: 1.5rem; margin-top: 10px; opacity: 0; animation: appear 2s ease-in-out 2s forwards;}
    @keyframes fadeIn {from {opacity:0;} to {opacity:1;}}
    @keyframes appear {to {opacity:1;}}
    .hamburger {position: absolute; top: 20px; right: 20px; width: 30px; height: 22px; cursor: pointer; z-index: 2;}
    .bar {width: 100%; height: 4px; background: white; margin: 4px 0; border-radius: 2px; transition: 0.4s;}
    body.light .bar {background: black;}
    .hamburger.active .bar:nth-child(1) {transform: translateY(8px) rotate(45deg);}
    .hamburger.active .bar:nth-child(2) {opacity: 0;}
    .hamburger.active .bar:nth-child(3) {transform: translateY(-8px) rotate(-45deg);}
    .sidebar {
      position: fixed; top: 0; left: -250px; width: 250px; height: 100%;
      background: rgba(0,0,0,0.85); backdrop-filter: blur(10px);
      transition: left 0.4s ease; padding-top: 60px; z-index: 1; overflow-y: auto;
    }
    .sidebar.light {background: rgba(255,255,255,0.85);}
    .sidebar::-webkit-scrollbar {width: 6px;}
    .sidebar::-webkit-scrollbar-thumb {background-color: rgba(255,255,255,0.2); border-radius: 3px;}
    .sidebar.active {left: 0;}
    .sidebar ul {list-style: none; padding: 0;}
    .sidebar li {
      padding: 15px 25px; border-bottom: 1px solid rgba(255,255,255,0.1);
      display: flex; align-items: center; gap: 10px; cursor: pointer;
      transition: background 0.3s;
    }
    .sidebar li:hover {background: rgba(255,255,255,0.1);}
    .divider {height: 1px; background: rgba(255,255,255,0.2); margin: 15px 0;}
    svg {width: 20px; height: 20px; fill: white;}
    body.light svg {fill: black;}

    /* Dock Styles */
    .dock {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      padding: 10px 20px;
      border-radius: 20px;
      display: flex;
      gap: 20px;
      z-index: 10;
      backdrop-filter: blur(10px);
    }
    .dock.light {background: rgba(255,255,255,0.7);}
    .dock-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: 0.3s;
      padding: 10px;
      border-radius: 10px;
    }
    .dock-item:hover {
      background: rgba(255,255,255,0.2);
      transform: scale(1.05);
    }
    body.light .dock-item:hover {background: rgba(0,0,0,0.2);}
    .dock-icon {
      width: 40px;
      height: 40px;
      background: #0077ff;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      margin-bottom: 5px;
    }
    .dock-label {
      font-size: 0.8rem;
      text-align: center;
    }

    /* Add Popup */
    .add-popup {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.4s ease, visibility 0.4s ease;
      z-index: 10;
    }
    .add-popup.active {opacity: 1; visibility: visible;}
    .add-box {
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      border-radius: 10px;
      padding: 20px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      animation: slideIn 0.5s ease-out;
    }
    .add-box h2 {font-size: 1.8rem; margin-bottom: 10px;}
    .add-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }
    .add-buttons button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      background: #0077ff;
      color: white;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    .add-buttons button:hover {background: #00aaff; transform: translateY(-2px);}
    .add-buttons button.cancel {background: rgba(255, 255, 255, 0.2);}
    .add-buttons button.cancel:hover {background: rgba(255, 255, 255, 0.3);}
    @keyframes slideIn {from {transform: translateY(-20px); opacity: 0;} to {transform: translateY(0); opacity: 1;}}
  </style>
</head>
<body>
  <canvas id="particles"></canvas>

  <div class="hamburger" id="hamburger">
    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
  </div>

  <div class="sidebar" id="sidebar">
    <ul>
      <li onclick="window.location.href='PluginsManagment.html'">
        <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.62l-1.92-3.32a.49.49 0 0 0-.6-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.49.49 0 0 0-.49-.42h-3.84a.49.49 0 0 0-.49.42l-.36 2.54c-.59.24-1.13.56-1.62.94l-2.39-.96a.49.49 0 0 0-.6.22l-1.92 3.32a.49.49 0 0 0 .12.62l2.03 1.58c-.05.3-.07.62-.07.94 0 .33.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.62l1.92 3.32a.49.49 0 0 0 .6.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54a.49.49 0 0 0 .49.42h3.84a.49.49 0 0 0 .49-.42l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96a.49.49 0 0 0 .6-.22l1.92-3.32a.49.49 0 0 0-.12-.62l-2.03-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg> Plugins Managment
      </li>
      <li onclick="window.location.href='AppSettings.html'">
        <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.62l-1.92-3.32a.49.49 0 0 0-.6-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.49.49 0 0 0-.49-.42h-3.84a.49.49 0 0 0-.49.42l-.36 2.54c-.59.24-1.13.56-1.62.94l-2.39-.96a.49.49 0 0 0-.6.22l-1.92 3.32a.49.49 0 0 0 .12.62l2.03 1.58c-.05.3-.07.62-.07.94 0 .33.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.62l1.92 3.32a.49.49 0 0 0 .6.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54a.49.49 0 0 0 .49.42h3.84a.49.49 0 0 0 .49-.42l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96a.49.49 0 0 0 .6-.22l1.92-3.32a.49.49 0 0 0-.12-.62l-2.03-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg> Settings
      </li>
      <li onclick="window.location.href='ChangeLog.html'">
        <svg viewBox="0 0 24 24"><path d="M13 3a9 9 0 0 0-9 9c0 3.97 2.59 7.34 6.16 8.47.38.07.52-.17.52-.38 0-.19-.01-.82-.01-1.49-2.51.54-3.04-.61-3.04-.61-.41-.99-.99-1.25-.99-1.25-1.34-1.06.1-.96.1-.96 1.48.1 2.27 1.55 2.27 1.55 2.02 3.45 5.31 2.46 6.61 1.88.2-1.46.79-2.46 1.44-3.02-1.98-.22-4.06-1-4.06-4.44 0-.98.35-1.78 1.02-2.41-.1-.25-.45-1.14.1-2.38 0 0 .84-.27 2.75 1.02A9.56 9.56 0 0 1 12 5.85c.85.004 1.71.11 2.52.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.24.2 2.13.1 2.38.67.63 1.02 1.43 1.02 2.41 0 3.45-2.09 4.22-4.08 4.44.32.28.61.83.61 1.67 0 1.21-.01 2.19-.01 2.49 0 .21.14.46.53.38A9.003 9.003 0 0 0 13 3z"/></svg> Change Log
      </li>
      <li onclick="window.location.href='example.html'">
        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg> About App
      </li>
    </ul>

    <div class="divider"></div>

    <ul>
      <li onclick="window.location.href='ColdBoots.html'">
        <svg viewBox="0 0 24 24"><path d="M12 2L2 12h3v8h6v-6h2v6h6v-8h3L12 2zm0 4.5l5.5 5.5H14v5h-4v-5H6.5L12 6.5z"/></svg> Coldboots
      </li>
      <li onclick="window.location.href='FileManager.html'">
        <svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/></svg> File Manager
      </li>
    </ul>

    <div class="divider"></div>

    <ul>
      <li onclick="window.location.href='Community.html'">
        <svg viewBox="0 0 24 24"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg> Community
      </li>
      <li onclick="window.location.href='GameMods.html'">
        <svg viewBox="0 0 24 24"><path d="M21.58 16.08l-1.7-1.7c.36-.64.61-1.31.61-2.38 0-1.07-.25-1.74-.61-2.38l1.7-1.7c.36-.36.36-.92 0-1.28l-2.12-2.12c-.36-.36-.92-.36-1.28 0l-1.7 1.7C15.84 5.64 14.67 5.39 13 5.39c-1.67 0-2.84.25-3.48.61l-1.7-1.7c-.36-.36-.92-.36-1.28 0L4.42 6.42c-.36.36-.36.92 0 1.28l1.7 1.7C5.76 9.64 5.51 10.31 5.51 11.38c0 1.07.25 1.74.61 2.38l-1.7 1.7c-.36.36-.36.92 0 1.28l2.12 2.12c.36.36.92.36 1.28 0l1.7-1.7c.64.36 1.31.61 2.38.61 1.07 0 1.74-.25 2.38-.61l1.7 1.7c.36.36.92.36 1.28 0l2.12-2.12c.36-.36.36-.92 0-1.28zM12 15c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3z"/></svg> Game Mods
      </li>
      <li onclick="window.location.href='GameSaves.html'">
        <svg viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H9V7h6v2z"/></svg> Game Saves
      </li>
      <li onclick="window.location.href='Homebrew.html'">
        <svg viewBox="0 0 24 24"><path d="M12 2L2 7v6c0 5.55 3.84 10.74 10 12 6.16-1.26 10-6.45 10-12V7l-10-5z"/></svg> Homebrew
      </li>
      <li onclick="window.location.href='PSNGames.html'">
        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg> PSN Games
      </li>
      <li onclick="window.location.href='Resources.html'">
        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg> Resources
      </li>
      <li onclick="window.location.href='Themes.html'">
        <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg> Themes
      </li>
    </ul>
  </div>

  <!-- Add Tools Hub Popup -->
  <div class="add-popup" id="addPopup">
    <div class="add-box">
      <h2>Add Tools Hubs</h2>
      <div id="hubOptions"></div>
      <div class="add-buttons">
        <button onclick="addSelectedHubs()">Add</button>
        <button class="cancel" onclick="closeAddPopup()">Cancel</button>
      </div>
    </div>
  </div>

  <div class="container">
    <h1 id="mainText">CellBreakers Desktop</h1>
    <div class="welcome" id="welcomeText">Welcome Back!</div>
  </div>

  <div class="dock" id="dock"></div>

  <script>
    // Hamburger Menu
    const hamburger = document.getElementById('hamburger');
    const sidebar = document.getElementById('sidebar');
    hamburger.addEventListener('click', () => {
      hamburger.classList.toggle('active');
      sidebar.classList.toggle('active');
    });

    // Particles Background
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    let particlesArray = [];
    const colors = ['#00aaff','#0077ff','#003366'];
    function resizeCanvas(){canvas.width=window.innerWidth;canvas.height=window.innerHeight;}
    window.addEventListener('resize',resizeCanvas);resizeCanvas();

    class Particle{
      constructor(){
        this.x=Math.random()*canvas.width;
        this.y=Math.random()*canvas.height;
        this.size=Math.random()*2+1;
        this.speedX=(Math.random()-0.5)*0.5;
        this.speedY=(Math.random()-0.5)*0.5;
        this.color=colors[Math.floor(Math.random()*colors.length)];
      }
      update(){
        this.x+=this.speedX;
        this.y+=this.speedY;
        if(this.x<0||this.x>canvas.width)this.speedX*=-1;
        if(this.y<0||this.y>canvas.height)this.speedY*=-1;
      }
      draw(){
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
        ctx.fillStyle=this.color;
        ctx.fill();
      }
    }
    function initParticles(){
      particlesArray=[];
      for(let i=0;i<80;i++){
        particlesArray.push(new Particle());
      }
    }
    function animateParticles(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      particlesArray.forEach(p=>{p.update();p.draw();});
      requestAnimationFrame(animateParticles);
    }
    initParticles();
    animateParticles();

    // Settings
    function getSettings() {
      return localStorage.getItem('settings') ? JSON.parse(localStorage.getItem('settings')) : {};
    }
    function saveSettings(settings) {
      localStorage.setItem('settings', JSON.stringify(settings));
    }
    function applyDisplayMode(mode, bg) {
      let background = bg;
      if (mode !== 'original') {
        if (mode === 'dark') background = '#111111,#333333';
        else if (mode === 'oled') background = '#000000,#000000';
      }
      document.body.style.background = background.includes(',') ? `linear-gradient(135deg, ${background})` : background;
    }
    function applyUITheme(theme) {
      const dock = document.getElementById('dock');
      if (theme === 'light') {
        document.body.classList.add('light');
        sidebar.classList.add('light');
        dock.classList.add('light');
      } else {
        document.body.classList.remove('light');
        sidebar.classList.remove('light');
        dock.classList.remove('light');
      }
    }
    function applyParticles(enabled) {
      canvas.style.display = enabled ? 'block' : 'none';
    }
    function loadSettings() {
      const settings = getSettings();
      applyUITheme(settings.theme ?? 'dark');
      applyDisplayMode(settings.displayMode ?? 'original', settings.bg ?? '#00111a,#003366');
      applyParticles(settings.particles ?? true);
      buildDock(settings);
    }

    // Dock Hubs (Coldboots & PS3HEN Coldboots REMOVED from here)
    const availableHubs = [
      { id: 'hash', name: 'File Hash Checker', icon: 'Lock', url: 'BuiltInHash.html', external: false }
    ];

    function buildDock(settings) {
      const dock = document.getElementById('dock');
      dock.innerHTML = '';
      const selected = settings.selectedHubs || [];
      selected.forEach(hubId => {
        const hub = availableHubs.find(h => h.id === hubId);
        if (hub) {
          const item = document.createElement('div');
          item.classList.add('dock-item');
          item.innerHTML = `
            <div class="dock-icon">${hub.icon}</div>
            <div class="dock-label">${hub.name}</div>
          `;
          item.onclick = () => {
            if (hub.external) {
              window.open(hub.url, '_blank');
            } else {
              window.location.href = hub.url;
            }
          };
          dock.appendChild(item);
        }
      });
      if (selected.length < 4) {
        const addItem = document.createElement('div');
        addItem.classList.add('dock-item');
        addItem.innerHTML = `
          <div class="dock-icon">+</div>
          <div class="dock-label">Add</div>
        `;
        addItem.onclick = showAddPopup;
        dock.appendChild(addItem);
      }
    }

    function showAddPopup() {
      const settings = getSettings();
      const selected = settings.selectedHubs || [];
      const optionsDiv = document.getElementById('hubOptions');
      optionsDiv.innerHTML = '';
      const available = availableHubs.filter(h => !selected.includes(h.id));
      if (available.length === 0) {
        optionsDiv.innerHTML = '<p>No more hubs available.</p>';
      } else {
        available.forEach(hub => {
          const label = document.createElement('label');
          label.innerHTML = `<input type="checkbox" value="${hub.id}"> ${hub.name}`;
          optionsDiv.appendChild(label);
        });
      }
      document.getElementById('addPopup').classList.add('active');
    }
    function closeAddPopup() {
      document.getElementById('addPopup').classList.remove('active');
    }
    function addSelectedHubs() {
      const settings = getSettings();
      const selected = settings.selectedHubs || [];
      const checkboxes = document.querySelectorAll('#hubOptions input:checked');
      const newHubs = Array.from(checkboxes).map(cb => cb.value);
      if (selected.length + newHubs.length > 4) {
        alert('You can only add up to 4 Tools Hubs.');
        return;
      }
      settings.selectedHubs = [...selected, ...newHubs];
      saveSettings(settings);
      closeAddPopup();
      buildDock(settings);
    }

    loadSettings();
  </script>
</body>
</html>
